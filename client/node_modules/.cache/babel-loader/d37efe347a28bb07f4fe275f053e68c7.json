{"ast":null,"code":"import axios from \"axios\";\nimport { tryCatchHandlr } from \"../../shared/helpers\";\nexport const submitHandlr = async (e, isLogin, authContxt, history) => {\n  e.preventDefault();\n  const request = axios.post(`/users/${isLogin ? 'login' : 'register'}`, authPayload(e), {\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  });\n  const [data, error] = await tryCatchHandlr(request);\n  authDataAndErrorHandlr([data, error], history, authContxt);\n};\n/*** HELPERS ***/\n\nfunction authPayload(e) {\n  const payload = {};\n\n  for (const [i, el] of [...e.target].entries()) {\n    //to omit 'submit el' key value pair to payload\n    if (i + 1 === e.target.length) break;\n    payload[el.name] = el.value;\n  }\n\n  return payload;\n}\n\nfunction authDataAndErrorHandlr(arr, history, authContxt) {\n  const [data, error] = arr;\n\n  if (data) {\n    authContxt.loginHandlr();\n    history.replace('/dashboard');\n    return;\n  } // TODO create a login error to show error message on welcome\n\n\n  console.log(error);\n  history.replace('/');\n  authContxt.errLoginHandlr();\n  return;\n}","map":{"version":3,"sources":["/Users/migueldacanay/Desktop/projects/int/brivity/react_coding_exercise/client/src/components/AuthForm/handlrs.js"],"names":["axios","tryCatchHandlr","submitHandlr","e","isLogin","authContxt","history","preventDefault","request","post","authPayload","headers","data","error","authDataAndErrorHandlr","payload","i","el","target","entries","length","name","value","arr","loginHandlr","replace","console","log","errLoginHandlr"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,cAAT,QAA+B,sBAA/B;AAEA,OAAO,MAAMC,YAAY,GAAG,OAAOC,CAAP,EAAUC,OAAV,EAAmBC,UAAnB,EAA+BC,OAA/B,KAA2C;AAEnEH,EAAAA,CAAC,CAACI,cAAF;AAEA,QAAMC,OAAO,GAAGR,KAAK,CAChBS,IADW,CACL,UAASL,OAAO,GAAG,OAAH,GAAY,UAAW,EADlC,EAERM,WAAW,CAACP,CAAD,CAFH,EAGR;AAACQ,IAAAA,OAAO,EAAE;AACN,sBAAgB;AADV;AAAV,GAHQ,CAAhB;AAQA,QAAM,CAACC,IAAD,EAAOC,KAAP,IAAgB,MAAMZ,cAAc,CAACO,OAAD,CAA1C;AAEAM,EAAAA,sBAAsB,CAAC,CAACF,IAAD,EAAOC,KAAP,CAAD,EAAgBP,OAAhB,EAAyBD,UAAzB,CAAtB;AAEH,CAhBM;AAmBP;;AACA,SAASK,WAAT,CAAqBP,CAArB,EAAuB;AACnB,QAAMY,OAAO,GAAG,EAAhB;;AAEA,OAAI,MAAM,CAACC,CAAD,EAAIC,EAAJ,CAAV,IAAqB,CAAC,GAAGd,CAAC,CAACe,MAAN,EAAcC,OAAd,EAArB,EAA6C;AACzC;AACA,QAAGH,CAAC,GAAC,CAAF,KAAQb,CAAC,CAACe,MAAF,CAASE,MAApB,EAA4B;AAC5BL,IAAAA,OAAO,CAACE,EAAE,CAACI,IAAJ,CAAP,GAAmBJ,EAAE,CAACK,KAAtB;AACH;;AAED,SAAOP,OAAP;AACH;;AAED,SAASD,sBAAT,CAAgCS,GAAhC,EAAqCjB,OAArC,EAA+CD,UAA/C,EAA0D;AACtD,QAAM,CAACO,IAAD,EAAOC,KAAP,IAAgBU,GAAtB;;AAEA,MAAGX,IAAH,EAAS;AACLP,IAAAA,UAAU,CAACmB,WAAX;AACAlB,IAAAA,OAAO,CAACmB,OAAR,CAAgB,YAAhB;AACA;AACH,GAPqD,CAStD;;;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYd,KAAZ;AACAP,EAAAA,OAAO,CAACmB,OAAR,CAAgB,GAAhB;AACApB,EAAAA,UAAU,CAACuB,cAAX;AACA;AACH","sourcesContent":["import axios from \"axios\";\nimport { tryCatchHandlr } from \"../../shared/helpers\";\n\nexport const submitHandlr = async (e, isLogin, authContxt, history) => {\n\n    e.preventDefault();\n\n    const request = axios\n        .post(`/users/${isLogin ? 'login': 'register'}`,\n            authPayload(e),\n            {headers: {\n                \"Content-Type\": \"application/json\",\n            }}, \n        );\n\n    const [data, error] = await tryCatchHandlr(request);\n\n    authDataAndErrorHandlr([data, error], history, authContxt);\n\n};\n\n\n/*** HELPERS ***/\nfunction authPayload(e){\n    const payload = {};\n\n    for(const [i, el] of [...e.target].entries()){\n        //to omit 'submit el' key value pair to payload\n        if(i+1 === e.target.length) break;\n        payload[el.name] = el.value;\n    }\n\n    return payload;\n}\n\nfunction authDataAndErrorHandlr(arr, history,  authContxt){\n    const [data, error] = arr;\n\n    if(data) {\n        authContxt.loginHandlr();\n        history.replace('/dashboard');\n        return;\n    }    \n    \n    // TODO create a login error to show error message on welcome\n    console.log(error);\n    history.replace('/');\n    authContxt.errLoginHandlr();\n    return;\n}"]},"metadata":{},"sourceType":"module"}